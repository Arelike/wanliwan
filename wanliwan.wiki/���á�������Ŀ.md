这个项目目前采用 [Node.js][1] 作为服务器端程序，进行开发。所以，很多信息可以从 [node.js][1] 的官方网站得到。而这个文档只是为了简化协同开发的环境配置而写的一个文档。 

## 安装必要软件

这个项目采用 [node.js][1] 进行开发，但考虑到很多 Linux 发行版并没有很快地对 [node.js][1] 进行更新，所以，这里采用 [visionmedia][2] 编写的 [node.js](1) 的版本管理器 [n][3] ，这个脚本可以通过 ```npm``` 进行安装。步骤如下，没有特别说明，执行命令都是指在 bash 命令行下：

   在Fedora下，如果没有对用户进行sudo的权限设置，那么，下面的sudo获取权限的方法改为
   
   ```bash
   $ su
   ```
   
   则之后的命令行去掉sudo

1. 安装 [n](3) 

   在 [n](3) 的主页 <https://github.com/visionmedia/n> 上获取 [n][3] 的源码，解压下载到的zip包，执行

   ```bash
   $ sudo make install
   ```

   安装过程很快就会完成。（实际上 [n][3] 是一个 对 [node.js][1] 版本进行控制的 Shell 脚本。）

2. 安装 [node.js][1]

   安装过程需要 ```g++``` 等编译工具，因为 `n` 实际上是从官方网站中获取版本信息，下载版本然后在本地执行编译的。

   ```bash
   $ yum install gcc-c++ 
   ```

   ```bash
   $ yum install wget 
   ```


   安装 [node.js][1] 不需要手动下载 [node.js][1] 的源码，应用 [n][3] 的源码管理，在终端执行以下命令：

   ```bash
   $ sudo n stable 
   ```

   即可下载到 [node.js][1] 的稳定版本。
   
   在部分版本中，这样下载的 [node.js][1] 的路径可能还是不正确，特别是 `npm` 的路径，所以，可能需要单独处理一下 `npm` 的路径。使用 

   ```bash
   ln -s /usr/local/n/current/bin/npm /usr/local/bin/npm
   ```
   
为 `npm` 创建软链接。

3. 设置本地代码

   从 [项目主页](https://github.com/yfwz100/wanliwan) 中获取源码，即执行以下命令：

   ```bash
   $ git clone https://github.com/yfwz100/wanliwan.git
   ```

   如果配置了 SSH 也可以通过 SSH 的方式来获取 wanliwan 的代码库。更多关于 `git` 的操作，可以参考[git 设置](wiki/git简略教程)页面。

4. 安装相关模块

   安装 MongoDB ，因为 MongoDB 已经比较稳定了，所以，我们可以直接采用软件源的 MongoDB 包进行项目部署。执行以下命令：

   ```bash
   $ sudo yum install mongodb mongodb-server # sudo apt-get install mongodb mongodb-server
   ```

   安装 MongoDB 后，在 wanliwan 项目根目录下，执行以下代码：

   ```bash
   $ npm install
   ```

   npm 会 自动获取相关的模块。具体的依赖在 package.json 里定义，可以参考 [node.js][1] 的文档。

## 测试执行

1. 启动 MongoDB，如果发行版默认启动了 [MongoDB][4]，可以直接忽略这一步。

   ```bash
   $ mkdir data
   $ mongod --dbpath ./data
   ```

   即把当前的 data 目录作为数据库文件夹，启动 [MongoDB][4] 服务器。数据库文件夹可以随意指定。

2. 运行测试程序：

   ```bash
   $ node app.js
   ```

   然后，在 [http://localhost:3000/](http://localhost:3000) 中即可测试运行结果。

[1]: https://github.com/joyent/node "Node.js GitHub Page"
[2]: https://github.com/visionmedia "Visionmedia's GitHub Page"
[3]: https://github.com/visionmedia/n "node.js GitHub Page"
[4]: https://github.com/mongodb/mongodb "MongoDB GitHub Page"